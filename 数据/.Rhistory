y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,1], ey[,2],pch=20)
plot(ey[,2], ey[,1],pch=20)
T <- 200
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
T <- 500
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
T <- 1000
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
T <- 5000
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
T <- 10000
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
T <- 5000
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
T <- 2000
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
T <- 3000
eps<-rnorm(T)
y <- 0
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- 1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
plot(y,type="b",pch=20)
abline(h=r)
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y,type="b",pch=20)
abline(h=r)
plot(y[1000:1500],type="b",pch=20)
abline(h=r)
a<-c(-1.5,0.5)
r <- 1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- -1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
a<-c(-1.5,0.5)
r <- 1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
a<-c(-1.5,0.5)
r <- -1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- 1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
#abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- -1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
#abline(h=r)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
?arima.sim()
y <- arima.sim(model=list(ar=0.5),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
y <- arima.sim(model=list(ar=-0.5),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
y <- arima.sim(model=list(ar=c(0.6,0.3)),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,2)
plot(ey[,2], ey[,1],pch=20)
ey<-embed(y,3)
plot(ey[,3], ey[,1],pch=20)
y <- arima.sim(model=list(ar=0.5),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,3)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
y <- arima.sim(model=list(ar=-0.5),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,3)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
y <- arima.sim(model=list(ar=c(0.6,0.3)),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,4)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
plot(ey[,4], ey[,1],pch=20)
alpha_1 <- 0.6
alpha_2 <- -0.3
rho_0 <- 1
rho <- alpha_1/(1-alpha_2)
rho[2] <- alpha_1*rho[1]+alpha_2*rho_0
for (s in 3:10) rho[s] <- alpha_1*rho[s-1]+alpha_2*rho[s-2]
alpha_1 <- 0.6
alpha_2 <- 0.3
rho_0 <- 1
rho <- alpha_1/(1-alpha_2)
rho[2] <- alpha_1*rho[1]+alpha_2*rho_0
for (s in 3:10) rho[s] <- alpha_1*rho[s-1]+alpha_2*rho[s-2]
alpha1 <- 0.5
rho_0 <- 1
rho <- alpha1*rho_0
for (s in 2:10) rho[s] <- alpha1*rho[s-1]
alpha1 <- 0.8
rho_0 <- 1
rho <- alpha1*rho_0
for (s in 2:10) rho[s] <- alpha1*rho[s-1]
y <- arima.sim(model=list(ar=alpha1),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,3)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
?abline()
abline(a=0, b=rho[2])
abline(a=0, b=rho[1])
alpha1 <- 0.8
rho <- alpha1*rho_0
for (s in 2:10) rho[s] <- alpha1*rho[s-1]
y <- arima.sim(model=list(ar=alpha1),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,3)
plot(ey[,2], ey[,1],pch=20)
abline(a=0, b=rho[1])
plot(ey[,3], ey[,1],pch=20)
abline(a=0, b=rho[2])
abline(h=0,v=0)
T <- 300
y <- arima.sim(model=list(ar=alpha1),n=T)
ey<-embed(y,3)
plot(ey[,2], ey[,1],pch=20)
abline(a=0, b=rho[1])
plot(ey[,3], ey[,1],pch=20)
abline(a=0, b=rho[2])
abline(h=0,v=0)
abline(h=0,h=0.64,v=0, v=1)
abline(h=c(0,0.64),v=c(0, 1))
T <- 3000
alpha1 <- 0.8
rho <- alpha1*rho_0
for (s in 2:10) rho[s] <- alpha1*rho[s-1]
y <- arima.sim(model=list(ar=alpha1),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,3)
plot(ey[,2], ey[,1],pch=20)
abline(a=0, b=rho[1])
plot(ey[,3], ey[,1],pch=20)
abline(a=0, b=rho[2])
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
abline(a=0, b=rho[1])
abline(h=c(0,rho[1]),v=c(0, 1))
plot(ey[,3], ey[,1],pch=20)
abline(a=0, b=rho[2])
plot(ey[,4], ey[,1],pch=20)
abline(a=0, b=rho[3])
plot(ey[,5], ey[,1],pch=20)
abline(a=0, b=rho[4])
plot(ey[,6], ey[,1],pch=20)
abline(a=0, b=rho[5])
alpha1 <- 0.6
alpha2 <- 0.3
rho <- alpha1/(1-alpha2)
rho[2] <- alpha1*rho[1]+alpha2*rho_0
for (s in 3:10) rho[s] <- alpha1*rho[s-1]+alpha2*rho[s-2]
y <- arima.sim(model=list(ar=c(alpha1,alpha2)),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
abline(a=0, b=rho[1])
abline(h=c(0,rho[1]),v=c(0, 1))
plot(ey[,3], ey[,1],pch=20)
abline(a=0, b=rho[2])
plot(ey[,4], ey[,1],pch=20)
abline(a=0, b=rho[3])
plot(ey[,5], ey[,1],pch=20)
abline(a=0, b=rho[4])
plot(ey[,6], ey[,1],pch=20)
abline(a=0, b=rho[5])
alpha1 <- -0.8
rho <- alpha1*rho_0
for (s in 2:10) rho[s] <- alpha1*rho[s-1]
y <- arima.sim(model=list(ar=alpha1),n=T)
plot(y[1000:1500],type="b",pch=20)
ey<-embed(y,3)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
abline(a=0, b=rho[1])
abline(h=c(0,rho[1]),v=c(0, 1))
plot(ey[,3], ey[,1],pch=20)
abline(a=0, b=rho[2])
plot(ey[,4], ey[,1],pch=20)
abline(a=0, b=rho[3])
plot(ey[,5], ey[,1],pch=20)
abline(a=0, b=rho[4])
plot(ey[,6], ey[,1],pch=20)
abline(a=0, b=rho[5])
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
#abline(h=r)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
plot(ey[,4], ey[,1],pch=20)
plot(ey[,5], ey[,1],pch=20)
plot(ey[,6], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- 1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
#abline(h=r)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
plot(ey[,4], ey[,1],pch=20)
plot(ey[,5], ey[,1],pch=20)
plot(ey[,6], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- -1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
#abline(h=r)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
plot(ey[,4], ey[,1],pch=20)
plot(ey[,5], ey[,1],pch=20)
plot(ey[,6], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- 1
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
#abline(h=r)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
plot(ey[,4], ey[,1],pch=20)
a<-c(-1.5,0.5)
r <- 0
for(i in 2:T){
if(y[i-1] < r)
y[i] <- a[1]*y[i-1]+eps[i]
else y[i] <- a[2]*y[i-1]+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
#abline(h=r)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
plot(ey[,3], ey[,1],pch=20)
a<-c(0.8)
r <- -1
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
a<-c(0.3)
r <- -1
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
plot(y[1000:1500],type="b",pch=20)
tail(y)
T <- 300
a<-c(0.3)
r <- -1
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
tail(y)
T <- 30
a<-c(0.3)
r <- -1
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
tail(y)
T <- 30
a<-c(0.3)
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
rm(y)
T <- 30
a<-c(0.3)
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
T <- 30
y <- 0
a<-c(0.3)
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
tail(y)
plot(y,type="b",pch=20)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
rm(y)
T <- 300
y <- 0
a<-c(0.3)
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
plot(y,type="b",pch=20)
T <- 300
y <- 0
a<-c(0.1)
for(i in 2:T){
y[i] <- a[1]*y[i-1]^2+eps[i]
}
plot(y,type="b",pch=20)
ey<-embed(y,6)
plot(ey[,2], ey[,1],pch=20)
setwd("F:/BaiduNetdiskWorkspace/lectures/Tsay/R/data")
data<-read.table("m2.txt",header=TRUE,sep="")
m<-data[,2]
garchspec<-ugarchspec(variance.model=list(model ="sGARCH",garchOrder=c(1,1), submodel = NULL, external.regressors = NULL, variance.targeting = FALSE), mean.model = list(armaOrder = c(4, 12), include.mean = TRUE, archm = FALSE, archpow=1,arfima = FALSE, external.regressors=NULL,archex=FALSE), distribution.model="norm", fixed.pars = list(ar3=0,ma1=0,ma2=0,ma3=0,ma4=0,ma5=0,ma6=0,ma7=0,ma8=0,ma9=0,ma10=0,ma11=0))
garchfit<-ugarchfit(garchspec,data=m,solver="solnp")
garchfit
library(rugarch)
garchspec<-ugarchspec(variance.model=list(model ="sGARCH",garchOrder=c(1,1), submodel = NULL, external.regressors = NULL, variance.targeting = FALSE), mean.model = list(armaOrder = c(4, 12), include.mean = TRUE, archm = FALSE, archpow=1,arfima = FALSE, external.regressors=NULL,archex=FALSE), distribution.model="norm", fixed.pars = list(ar3=0,ma1=0,ma2=0,ma3=0,ma4=0,ma5=0,ma6=0,ma7=0,ma8=0,ma9=0,ma10=0,ma11=0))
garchfit<-ugarchfit(garchspec,data=m,solver="solnp")
garchfit
mean<-arima(m, order=c(4,0,0), seasonal=list(order=c(1,0,0), period=12), fixed=c(NA,NA,0,NA,NA,NA), transform.pars = FALSE)
mean
Box.test(mean$residuals^2, lag=8, type = "Ljung", fitdf=5)
